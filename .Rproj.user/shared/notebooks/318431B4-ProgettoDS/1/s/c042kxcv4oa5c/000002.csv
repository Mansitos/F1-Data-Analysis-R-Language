"0","# Building historical data for constructors (win in seasons)"
"0","years=c(1958:2020)"
"0",""
"0","# who won each year"
"0","input_data2 = full_join(races_year,constrStand,by=""raceId"") %>% select(year,constructorId,position,raceId) %>% filter(year>=1958) %>% filter(position==1) %>% group_by(year) %>% top_n(1,raceId) %>% select(-raceId,-position)"
"0",""
"0","constructors_names = constr_stats %>% select(name,constructorId)"
"0",""
"0","history_data = tibble()"
"0",""
"0","for(i in years){"
"0","  data = input_data2 %>% filter(year <= i)"
"0","  rows = data %>% group_by(constructorId)%>% count(constructorId) %>% rename(seasons_won=n) %>% mutate(year=i)"
"0","  history_data = rbind(history_data,rows)"
"0","}"
"0",""
"0","# adding constr name to historical data"
"0","history_data <-  right_join(constructors_names,history_data,by=""constructorId"")"
"0",""
"0","#filter "
"0","ok_constr = constr_stats %>% arrange(desc(championships))"
"0","ok_constr = ok_constr %>% filter(championships>1)"
"0",""
"0","history_data_filtered = inner_join(ok_constr,history_data,by=""name"") %>% mutate(constructorId=constructorId.x) %>% select(-constructorId.y)"
"0",""
"0","history_data_filtered = history_data_filtered %>% mutate(label=paste(name,""-"",championships))"
