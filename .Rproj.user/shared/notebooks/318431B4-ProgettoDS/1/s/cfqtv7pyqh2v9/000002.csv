"0","# Building historical data for constructors (partecipation in seasons)"
"0","years=c(1950:2020)"
"0",""
"0","input_data2 = full_join(races_year,results,by=""raceId"") %>% select(year,constructorId) %>% filter(year>=1950)"
"0","input_data2 = unique(input_data2)"
"0",""
"0","constructors_names = constr_stats %>% select(name,constructorId)"
"0",""
"0","history_data = tibble()"
"0",""
"0","for(i in years){"
"0","  data = input_data2 %>% filter(year <= i)"
"0","  row = data %>% count(constructorId) %>% rename(seasons_held=n) %>% mutate(year=i)"
"0","  history_data = rbind(history_data,row)"
"0","}"
"0",""
"0","# adding constr name to historical data"
"0","history_data <-  right_join(constructors_names,history_data,by=""constructorId"")"
"0",""
"0","#filter "
"0","n = 10"
"0","ok_constr = constr_stats %>% arrange(desc(held_seasons))"
"0","ok_constr = ok_constr[0:n,]"
"0",""
"0","history_data_filtered = inner_join(ok_constr,history_data,by=""name"") %>% mutate(constructorId=constructorId.x) %>% select(-constructorId.y)"
"0",""
"0","history_data_filtered = history_data_filtered %>% mutate(label=paste(name,""-"",held_seasons))"
"0",""
"0","if(FALSE){"
"0","gif_data = history_data_filtered  %>% ggplot(aes(x=year,y=seasons_held,group=constructorId,color=reorder(label,-held_seasons)))+"
"0","    geom_line(size=1.3) +"
"0","    geom_point(size=2.5) +"
"0","    ggtitle(""Historical evolution of n° held seasons for top 10 constructors who participated the most"") +"
"0","    ylab(""n° held seasons"") +"
"0","    xlab(""Year"") +"
"0","    transition_reveal(year) +"
"0","    scale_y_continuous(breaks = seq(0,75,5)) +"
"0","    scale_x_continuous(breaks = pretty(history_data_filtered$year, n = 10)) + "
"0","    labs(color='Constructor')"
"0",""
"0","animate(gif_data, duration = 17, fps = 24, width = 1500, height = 750, renderer = gifski_renderer())"
"0","anim_save(""held_seasons_by_constructor_evolution.gif"")"
"0","}"
"0",""
