"0","# Average of top 15 drivers performance per country (min 15 drivers)"
"0","allowed_countries = country_stats %>% filter(drivers >= 15) %>% select(country) "
"0",""
"0","allowed_drivers = inner_join(allowed_countries,driver_stats) %>% select(""country"",""performance_with_bonus"") %>% group_by(country) %>% top_n(15,performance_with_bonus)"
"0","allowed_drivers = unique(allowed_drivers)"
"0",""
"0","counts = allowed_drivers %>% group_by(country) %>% count(country)"
"0",""
"0","medium_performance_per_country = aggregate(allowed_drivers$performance_with_bonus,by=list(country=allowed_drivers$country),FUN=sum) %>% rename(average_perforamnce_with_bonus=x)"
"0","medium_performance_per_country = inner_join(medium_performance_per_country,counts,by=""country"") %>% mutate(average_perforamnce_with_bonus=average_perforamnce_with_bonus/n)"
"0",""
"0","data = medium_performance_per_country  %>% arrange(desc(average_perforamnce_with_bonus))"
"0",""
"0","ggplot(data=data,aes(x= reorder(country,average_perforamnce_with_bonus),y=average_perforamnce_with_bonus)) +"
"0","  geom_bar(aes(fill=average_perforamnce_with_bonus),color=""black"",size=0.35,stat = 'identity', show.legend = FALSE) +"
"0","  theme(axis.text.x = element_text(angle=52.5, vjust=1, hjust=1,size=9), plot.margin = margin(0.2, 0.5, 0, 0, ""cm""),plot.title = element_text(size = 10,face=""bold"")) +"
"0","  scale_y_continuous(breaks = pretty(data$average_perforamnce_with_bonus, n = 10)) +"
"0","  labs(x="""",y="""",title=""Average performance of top 15 drivers for each country"")+"
"0","  coord_flip()+"
"0","  scale_fill_distiller(palette=""YlOrRd"",direction = 1)"
