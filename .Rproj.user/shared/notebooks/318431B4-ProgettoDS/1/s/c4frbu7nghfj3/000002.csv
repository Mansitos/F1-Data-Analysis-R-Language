"2","r error 4 (R code execution error)"
"0","# Interrogo i dati per il calcolo di statistiche sui piloti"
"0",""
"0","# a ciascun pilota associo la nazione e rimuovo la nazionalità"
"0","driver_stats <- drivers %>% select(c(driverId,forename,surname,nationality,driverRef))"
"0","driver_stats <- inner_join(driver_stats,nat_to_country) %>% select(-c(nationality))"
"2","Joining, by = ""nationality""
"
"0","# n° gare disputate per pilota"
"0","held_races <- results %>% count(driverId) %>% rename(races=n)"
"0",""
"0","# n° vittorie per pilota"
"0","wins <- results %>% filter(position==1) %>% count(driverId) %>% rename(wins=n)"
"0",""
"0","# n° 2° posto per pilota"
"0","second <- results %>% filter(position==2) %>% count(driverId) %>% rename(second=n)"
"0",""
"0","# n° 3° posto per pilota"
"0","third <- results %>% filter(position==3) %>% count(driverId) %>% rename(third=n)"
"0",""
"0","# aggiungo i relativi ai podidati alla tabella iniziale, sostituendo NA con 0"
"0","stats <- full_join(held_races,wins,by=""driverId"")"
"0","stats <- full_join(stats,second,by=""driverId"")"
"0","stats <- full_join(stats,third,by=""driverId"")"
"0","stats[is.na(stats)] <- 0 # sostituisco NA con 0"
"0","driver_stats <- inner_join(driver_stats,stats)"
"2","Joining, by = ""driverId""
"
"0","rm(stats,wins,second,third) # cancello dataset temporaneai"
"0",""
"0","# Calcolo totale podi"
"0","driver_stats = driver_stats %>% mutate(podiums=wins+second+third)"
"0",""
"0","# Calcolo totale podium rate"
"0","driver_stats = driver_stats %>% mutate(podium_rate=podiums/races)"
"0",""
"0","# Calcolo win rate"
"0","driver_stats = driver_stats %>% mutate(win_rate=wins/races)"
"0",""
"0","# calcolo del full_name e rimuovo surname e name"
"0","driver_stats = driver_stats %>% mutate(full_name = paste(forename,surname)) %>% select(-surname,-forename)"
"0",""
"0","driver_stats"
