"0","# Calcolo statistiche piloti"
"0",""
"0","driver_stats <- drivers %>% select(c(driverId,forename,surname,nationality,driverRef))"
"0","driver_stats <- inner_join(driver_stats,nat_to_country) %>% select(-c(nationality))"
"2","Joining, by = ""nationality""
"
"0","# n° gare disputate per pilota"
"0","held_races <- results %>% count(driverId) %>% rename(races=n)"
"0",""
"0","# n° vittorie per pilota"
"0","wins <- results %>% filter(position==1) %>% count(driverId) %>% rename(wins=n)"
"0",""
"0","# n° 2° posto per pilota"
"0","second <- results %>% filter(position==2) %>% count(driverId) %>% rename(second=n)"
"0",""
"0","# n° 3° posto per pilota"
"0","third <- results %>% filter(position==3) %>% count(driverId) %>% rename(third=n)"
"0",""
"0",""
"0","# aggiungo i dati alla tabella iniziale, sostituendo NA con 0"
"0","stats <- full_join(held_races,wins,by=""driverId"")"
"0","stats <- full_join(stats,second,by=""driverId"")"
"0","stats <- full_join(stats,third,by=""driverId"")"
"0","stats[is.na(stats)] <- 0"
"0","driver_stats <- inner_join(driver_stats,stats)"
"2","Joining, by = ""driverId""
"
"0","rm(stats,wins,second,third) # cancello dataset temporaneai"
"0","driver_stats"
